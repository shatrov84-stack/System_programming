–û—Ç–ª–∏—á–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª –¥–ª—è —Ç—Ä–µ—Ç—å–µ–≥–æ —É—Ä–æ–∫–∞! –í–æ—Ç –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –≤ —Å—Ç–∏–ª–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —É—Ä–æ–∫–∞:

# üöÄ **–£–†–û–ö 3: –ü–†–û–¶–ï–°–°–´ WINDOWS ‚Äî –°–û–ó–î–ê–ù–ò–ï –ò –£–ü–†–ê–í–õ–ï–ù–ò–ï**

**–¶–µ–ª—å —É—Ä–æ–∫–∞:**  
–ü–æ–Ω–∏–º–∞—Ç—å –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª, —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ –º–µ—Ö–∞–Ω–∏–∑–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏ –≤ Windows. –ù–∞—É—á–∏—Ç—å—Å—è —Å–æ–∑–¥–∞–≤–∞—Ç—å, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å, –ø–µ—Ä–µ—á–∏—Å–ª—è—Ç—å –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã —Å –ø–æ–º–æ—â—å—é WinAPI.

---

## üìö **–¢–ï–û–†–ï–¢–ò–ß–ï–°–ö–ê–Ø –ß–ê–°–¢–¨ (–ø–æ –∫–Ω–∏–≥–µ –ò–æ—Å–∏—Ñ–æ–≤–∏—á–∞)**

### **–°—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è:**
- **–ì–ª–∞–≤–∞ 3 (—Å—Ç—Ä–∞–Ω–∏—Ü—ã 45-60):** "Process Basics" ‚Äî –æ—Å–Ω–æ–≤—ã –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- **–ì–ª–∞–≤–∞ 3 (—Å—Ç—Ä–∞–Ω–∏—Ü—ã 61-75):** "Process Creation and Termination" ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ
- **–ì–ª–∞–≤–∞ 3 (—Å—Ç—Ä–∞–Ω–∏—Ü—ã 76-85):** "Process Information and Enumeration" ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ

### **–ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏:**

#### **1. –ß—Ç–æ —Ç–∞–∫–æ–µ –ø—Ä–æ—Ü–µ—Å—Å Windows:**
- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ä–µ—Å—É—Ä—Å–æ–≤:** –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –∞–¥—Ä–µ—Å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ, –∫–æ–¥, –¥–∞–Ω–Ω—ã–µ, –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã
- **–û–±—ä–µ–∫—Ç —è–¥—Ä–∞:** –£–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –¥–∏—Å–ø–µ—Ç—á–µ—Ä–æ–º –æ–±—ä–µ–∫—Ç–æ–≤ Windows
- **–°–æ—Å—Ç–æ—è–Ω–∏—è:** –°–æ–∑–¥–∞–Ω, –≥–æ—Ç–æ–≤, –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è, –æ–∂–∏–¥–∞–µ—Ç, –∑–∞–≤–µ—Ä—à–µ–Ω
- **–ê—Ç—Ä–∏–±—É—Ç—ã:** PID, —Ç–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø–∞, –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç, –∫–≤–æ—Ç—ã

#### **2. –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤:**
- **`CreateProcess()`:** –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- **`STARTUPINFO`:** –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—É—Å–∫–∞ (–æ–∫–Ω–æ, –ø–æ—Ç–æ–∫–∏ –≤–≤–æ–¥–∞/–≤—ã–≤–æ–¥–∞)
- **`PROCESS_INFORMATION`:** –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ–∑–¥–∞–Ω–∏—è (–¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã, –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã)
- **–§–ª–∞–≥–∏ —Å–æ–∑–¥–∞–Ω–∏—è:** `CREATE_SUSPENDED`, `CREATE_NEW_CONSOLE`, `CREATE_UNICODE_ENVIRONMENT`

#### **3. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏:**
- **`WaitForSingleObject()`:** –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞
- **`GetExitCodeProcess()`:** –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–¥–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
- **`TerminateProcess()`:** –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ
- **`GetCurrentProcessId()`:** –ü–æ–ª—É—á–µ–Ω–∏–µ PID —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞

#### **4. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö:**
- **ToolHelp API:** `CreateToolhelp32Snapshot()`, `Process32First()`, `Process32Next()`
- **–°—Ç—Ä—É–∫—Ç—É—Ä—ã:** `PROCESSENTRY32` ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ—Ü–µ—Å—Å–µ
- **PSAPI:** –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏

#### **5. –û–∫—Ä—É–∂–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤:**
- **–ë–ª–æ–∫ –æ–∫—Ä—É–∂–µ–Ω–∏—è:** –ù–∞–±–æ—Ä —Å—Ç—Ä–æ–∫ "–ò–ú–Ø=–ó–ù–ê–ß–ï–ù–ò–ï"
- **`GetEnvironmentVariable()` / `SetEnvironmentVariable()`:** –†–∞–±–æ—Ç–∞ —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏
- **–ù–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ:** –î–æ—á–µ—Ä–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –ø–æ–ª—É—á–∞—é—Ç –∫–æ–ø–∏—é –æ–∫—Ä—É–∂–µ–Ω–∏—è —Ä–æ–¥–∏—Ç–µ–ª—è

---

## üìù **–ó–ê–î–ê–ù–ò–ï**

### **–ß–∞—Å—Ç—å 1: –¢–µ–æ—Ä–∏—è (–æ—Ç–≤–µ—Ç—å—Ç–µ –ø–∏—Å—å–º–µ–Ω–Ω–æ)**
1. –ß–µ–º –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è PID –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ—Ç –µ–≥–æ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞? –ü–æ—á–µ–º—É –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –Ω–∞–¥–µ–∂–Ω–µ–µ –¥–ª—è –¥–æ–ª–≥–æ–∂–∏–≤—É—â–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π?
2. –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç, –µ—Å–ª–∏ –Ω–µ –∑–∞–∫—Ä—ã—Ç—å –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã `hProcess` –∏ `hThread`, –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –∏–∑ `CreateProcess()`?
3. –ü–æ—á–µ–º—É –¥–ª—è –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `CreateToolhelp32Snapshot()` –≤–º–µ—Å—Ç–æ –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞?
4. –ö–∞–∫ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –¥–æ—á–µ—Ä–Ω–∏–º –ø—Ä–æ—Ü–µ—Å—Å–∞–º –∏ –º–æ–∂–Ω–æ –ª–∏ —ç—Ç–æ –∏–∑–º–µ–Ω–∏—Ç—å?
5. –ß—Ç–æ —Ç–∞–∫–æ–µ PPL (Protected Process Light) –∏ –∑–∞—á–µ–º –Ω—É–∂–µ–Ω —ç—Ç–æ—Ç –º–µ—Ö–∞–Ω–∏–∑–º?

### **–ß–∞—Å—Ç—å 2: –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞**

**–ó–∞–¥–∞—á–∞:** –°–æ–∑–¥–∞—Ç—å —É—Ç–∏–ª–∏—Ç—É –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏ Windows

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø—Ä–æ–≥—Ä–∞–º–º–µ:**
1. –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
3. –†–∞–±–æ—Ç–∞ —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è
4. –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–∑–Ω—ã—Ö —Å–ø–æ—Å–æ–±–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
5. –ü–æ–∏—Å–∫ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –ø–æ –∏–º–µ–Ω–∏ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è

---

## üíª **–ü–û–õ–ù–´–ô –ò–°–•–û–î–ù–´–ô –ö–û–î –ü–†–û–ì–†–ê–ú–ú–´**

```c
#define _CRT_SECURE_NO_WARNINGS
#define WIN32_LEAN_AND_MEAN

#include <windows.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <tlhelp32.h>
#include <tchar.h>

// –ü—Ä–æ—Ç–æ—Ç–∏–ø—ã —Ñ—É–Ω–∫—Ü–∏–π
void PrintMenu();
void CreateSimpleProcess();
void CreateProcessWithRedirect();
void ListAllProcesses();
void FindProcessByName();
void ManageProcessEnvironment();
void TerminateProcessDemo();
void ProcessInfoDemo();

// –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
void PrintError(const char* functionName, DWORD errorCode);
void PrintProcessInfo(PROCESSENTRY32* pe);
void WaitForProcessWithTimeout(HANDLE hProcess, DWORD timeoutMs);

// –ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
int main()
{
    // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Å–æ–ª–∏ –¥–ª—è —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞
    SetConsoleCP(1251);
    SetConsoleOutputCP(1251);
    
    _tprintf(_T("=== –£—Ç–∏–ª–∏—Ç–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏ Windows ===\n\n"));
    
    int choice = 0;
    TCHAR input[10];
    
    while (1)
    {
        PrintMenu();
        _tprintf(_T("–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ (1-8): "));
        
        if (_fgetts(input, sizeof(input) / sizeof(TCHAR), stdin) != NULL)
        {
            choice = _ttoi(input);
        }
        
        switch (choice)
        {
        case 1:
            CreateSimpleProcess();
            break;
        case 2:
            CreateProcessWithRedirect();
            break;
        case 3:
            ListAllProcesses();
            break;
        case 4:
            FindProcessByName();
            break;
        case 5:
            ManageProcessEnvironment();
            break;
        case 6:
            TerminateProcessDemo();
            break;
        case 7:
            ProcessInfoDemo();
            break;
        case 8:
            _tprintf(_T("–í—ã—Ö–æ–¥ –∏–∑ –ø—Ä–æ–≥—Ä–∞–º–º—ã.\n"));
            return 0;
        default:
            _tprintf(_T("–ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.\n"));
            break;
        }
        
        if (choice != 8)
        {
            _tprintf(_T("\n–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è..."));
            int ch;
            while ((ch = _gettchar()) != _T('\n') && ch != EOF);
        }
    }
    
    return 0;
}

// –§—É–Ω–∫—Ü–∏—è 1: –ü—Ä–æ—Å—Ç–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞
void CreateSimpleProcess()
{
    _tprintf(_T("\n=== –°–û–ó–î–ê–ù–ò–ï –ü–†–û–°–¢–û–ì–û –ü–†–û–¶–ï–°–°–ê ===\n\n"));
    
    STARTUPINFO si = { sizeof(si) };
    PROCESS_INFORMATION pi = { 0 };
    
    // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–æ–≥—Ä–∞–º–º—É –¥–ª—è –∑–∞–ø—É—Å–∫–∞
    _tprintf(_T("–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø—Ä–æ–≥—Ä–∞–º–º—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, notepad.exe): "));
    TCHAR cmdLine[MAX_PATH];
    
    if (_fgetts(cmdLine, MAX_PATH, stdin) == NULL)
    {
        _tprintf(_T("–û—à–∏–±–∫–∞ –≤–≤–æ–¥–∞.\n"));
        return;
    }
    
    // –£–±–∏—Ä–∞–µ–º —Å–∏–º–≤–æ–ª –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏
    size_t len = _tcslen(cmdLine);
    if (len > 0 && cmdLine[len - 1] == _T('\n'))
    {
        cmdLine[len - 1] = _T('\0');
    }
    
    // –ï—Å–ª–∏ —Å—Ç—Ä–æ–∫–∞ –ø—É—Å—Ç–∞—è, –∏—Å–ø–æ–ª—å–∑—É–µ–º notepad.exe –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    if (_tcslen(cmdLine) == 0)
    {
        _tcscpy_s(cmdLine, MAX_PATH, _T("notepad.exe"));
        _tprintf(_T("–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: %s\n"), cmdLine);
    }
    
    _tprintf(_T("\n–ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ—Ü–µ—Å—Å: %s\n"), cmdLine);
    _tprintf(_T("1. –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–±—ã—á–Ω—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç\n"));
    _tprintf(_T("2. –°–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–µ –∫–æ–Ω—Å–æ–ª—å–Ω–æ–µ –æ–∫–Ω–æ\n"));
    _tprintf(_T("3. –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–∫—Ä—É–∂–µ–Ω–∏–µ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞\n\n"));
    
    // –°–æ–∑–¥–∞–µ–º –ø—Ä–æ—Ü–µ—Å—Å
    BOOL success = CreateProcess(
        NULL,                   // –ò–º—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (—É–∫–∞–∑—ã–≤–∞–µ–º –≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ)
        cmdLine,                // –ö–æ–º–∞–Ω–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞
        NULL,                   // –ê—Ç—Ä–∏–±—É—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞
        NULL,                   // –ê—Ç—Ä–∏–±—É—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø–æ—Ç–æ–∫–∞
        FALSE,                  // –ù–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤
        CREATE_NEW_CONSOLE,     // –§–ª–∞–≥–∏ —Å–æ–∑–¥–∞–Ω–∏—è
        NULL,                   // –û–∫—Ä—É–∂–µ–Ω–∏–µ (–∏—Å–ø–æ–ª—å–∑—É–µ–º —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–µ)
        NULL,                   // –¢–µ–∫—É—â–∏–π –∫–∞—Ç–∞–ª–æ–≥
        &si,                    // STARTUPINFO
        &pi                     // PROCESS_INFORMATION
    );
    
    if (!success)
    {
        PrintError("CreateProcess", GetLastError());
        return;
    }
    
    _tprintf(_T("‚úì –ü—Ä–æ—Ü–µ—Å—Å —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!\n"));
    _tprintf(_T("   PID –ø—Ä–æ—Ü–µ—Å—Å–∞: %lu\n"), pi.dwProcessId);
    _tprintf(_T("   PID –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞: %lu\n"), pi.dwThreadId);
    _tprintf(_T("   –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞: 0x%p\n"), pi.hProcess);
    
    // –î–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤—ã–±–æ—Ä: –∂–¥–∞—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–ª–∏ –Ω–µ—Ç
    _tprintf(_T("\n–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:\n"));
    _tprintf(_T("1. –ñ–¥–∞—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞\n"));
    _tprintf(_T("2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å (–Ω–µ –∂–¥–∞—Ç—å)\n"));
    _tprintf(_T("–í–∞—à –≤—ã–±–æ—Ä: "));
    
    TCHAR choice[10];
    _fgetts(choice, sizeof(choice) / sizeof(TCHAR), stdin);
    
    if (_ttoi(choice) == 1)
    {
        _tprintf(_T("\n–û–∂–∏–¥–∞–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞...\n"));
        WaitForProcessWithTimeout(pi.hProcess, 30000); // 30 —Å–µ–∫—É–Ω–¥ —Ç–∞–π–º–∞—É—Ç
    }
    else
    {
        _tprintf(_T("\n–ü—Ä–æ—Ü–µ—Å—Å –∑–∞–ø—É—â–µ–Ω –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ.\n"));
        _tprintf(_T("–î–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞—à –º–æ–Ω–∏—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.\n"));
    }
    
    // –ó–∞–∫—Ä—ã–≤–∞–µ–º –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã (–≤–∞–∂–Ω–æ –≤—Å–µ–≥–¥–∞ —ç—Ç–æ –¥–µ–ª–∞—Ç—å!)
    CloseHandle(pi.hProcess);
    CloseHandle(pi.hThread);
    
    _tprintf(_T("\n–î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã –∑–∞–∫—Ä—ã—Ç—ã.\n"));
}

// –§—É–Ω–∫—Ü–∏—è 2: –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –≤—ã–≤–æ–¥–∞
void CreateProcessWithRedirect()
{
    _tprintf(_T("\n=== –°–û–ó–î–ê–ù–ò–ï –ü–†–û–¶–ï–°–°–ê –° –ü–ï–†–ï–ù–ê–ü–†–ê–í–õ–ï–ù–ò–ï–ú –í–´–í–û–î–ê ===\n\n"));
    
    _tprintf(_T("–≠—Ç–æ—Ç –ø—Ä–∏–º–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç cmd.exe —Å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –≤—ã–≤–æ–¥–∞ –≤ —Ñ–∞–π–ª.\n"));
    
    // –°–æ–∑–¥–∞–µ–º —Ñ–∞–π–ª –¥–ª—è –≤—ã–≤–æ–¥–∞
    HANDLE hOutputFile = CreateFile(
        _T("process_output.txt"),
        GENERIC_WRITE,
        FILE_SHARE_READ,
        NULL,
        CREATE_ALWAYS,
        FILE_ATTRIBUTE_NORMAL,
        NULL
    );
    
    if (hOutputFile == INVALID_HANDLE_VALUE)
    {
        PrintError("CreateFile", GetLastError());
        return;
    }
    
    // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º STARTUPINFO –¥–ª—è –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
    STARTUPINFO si = { sizeof(si) };
    PROCESS_INFORMATION pi = { 0 };
    
    si.dwFlags = STARTF_USESTDHANDLES;
    si.hStdInput = GetStdHandle(STD_INPUT_HANDLE);
    si.hStdOutput = hOutputFile;     // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º stdout –≤ —Ñ–∞–π–ª
    si.hStdError = hOutputFile;      // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º stderr –≤ —Ç–æ—Ç –∂–µ —Ñ–∞–π–ª
    
    // –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
    TCHAR cmdLine[] = _T("cmd.exe /c dir & echo Hello from redirected process!");
    
    _tprintf(_T("–ó–∞–ø—É—Å–∫–∞–µ–º –∫–æ–º–∞–Ω–¥—É: %s\n"), cmdLine);
    _tprintf(_T("–í—ã–≤–æ–¥ –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ process_output.txt\n\n"));
    
    // –°–æ–∑–¥–∞–µ–º –ø—Ä–æ—Ü–µ—Å—Å
    BOOL success = CreateProcess(
        NULL,
        cmdLine,
        NULL,
        NULL,
        TRUE,                   // TRUE = –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã –Ω–∞—Å–ª–µ–¥—É—é—Ç—Å—è
        CREATE_NO_WINDOW,       // –ù–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ–∫–Ω–æ
        NULL,
        NULL,
        &si,
        &pi
    );
    
    if (!success)
    {
        PrintError("CreateProcess", GetLastError());
        CloseHandle(hOutputFile);
        return;
    }
    
    _tprintf(_T("–ü—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω. PID: %lu\n"), pi.dwProcessId);
    
    // –ñ–¥–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
    WaitForSingleObject(pi.hProcess, 5000);
    
    // –ü–æ–ª—É—á–∞–µ–º –∫–æ–¥ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
    DWORD exitCode;
    if (GetExitCodeProcess(pi.hProcess, &exitCode))
    {
        _tprintf(_T("–ö–æ–¥ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è: %lu\n"), exitCode);
    }
    
    // –ó–∞–∫—Ä—ã–≤–∞–µ–º –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã
    CloseHandle(pi.hProcess);
    CloseHandle(pi.hThread);
    CloseHandle(hOutputFile);
    
    _tprintf(_T("\n–í—ã–≤–æ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ process_output.txt\n"));
    _tprintf(_T("–°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞:\n"));
    _tprintf(_T("================\n"));
    
    // –ß–∏—Ç–∞–µ–º –∏ –≤—ã–≤–æ–¥–∏–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞
    FILE* file = _tfopen(_T("process_output.txt"), _T("r"));
    if (file)
    {
        TCHAR buffer[256];
        while (_fgetts(buffer, sizeof(buffer) / sizeof(TCHAR), file))
        {
            _tprintf(_T("%s"), buffer);
        }
        fclose(file);
    }
}

// –§—É–Ω–∫—Ü–∏—è 3: –ü–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
void ListAllProcesses()
{
    _tprintf(_T("\n=== –°–ü–ò–°–û–ö –í–°–ï–• –ü–†–û–¶–ï–°–°–û–í ===\n\n"));
    
    // –°–æ–∑–¥–∞–µ–º —Å–Ω–∏–º–æ–∫ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
    HANDLE hSnapshot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);
    
    if (hSnapshot == INVALID_HANDLE_VALUE)
    {
        PrintError("CreateToolhelp32Snapshot", GetLastError());
        return;
    }
    
    PROCESSENTRY32 pe32;
    pe32.dwSize = sizeof(PROCESSENTRY32);
    
    _tprintf(_T("%-8s  %-40s  %-8s  %-8s\n"), 
             _T("PID"), _T("–ò–º—è –ø—Ä–æ—Ü–µ—Å—Å–∞"), _T("–ü–æ—Ç–æ–∫–æ–≤"), _T("–†–æ–¥–∏—Ç–µ–ª—å"));
    _tprintf(_T("--------------------------------------------------------------------------------\n"));
    
    // –ü–æ–ª—É—á–∞–µ–º –ø–µ—Ä–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å
    if (Process32First(hSnapshot, &pe32))
    {
        int count = 0;
        do
        {
            PrintProcessInfo(&pe32);
            count++;
        } while (Process32Next(hSnapshot, &pe32));
        
        _tprintf(_T("\n–í—Å–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤: %d\n"), count);
    }
    else
    {
        PrintError("Process32First", GetLastError());
    }
    
    CloseHandle(hSnapshot);
}

// –§—É–Ω–∫—Ü–∏—è 4: –ü–æ–∏—Å–∫ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø–æ –∏–º–µ–Ω–∏
void FindProcessByName()
{
    _tprintf(_T("\n=== –ü–û–ò–°–ö –ü–†–û–¶–ï–°–°–ê –ü–û –ò–ú–ï–ù–ò ===\n\n"));
    
    _tprintf(_T("–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, explorer.exe): "));
    TCHAR searchName[MAX_PATH];
    
    if (_fgetts(searchName, MAX_PATH, stdin) == NULL)
    {
        _tprintf(_T("–û—à–∏–±–∫–∞ –≤–≤–æ–¥–∞.\n"));
        return;
    }
    
    // –£–±–∏—Ä–∞–µ–º —Å–∏–º–≤–æ–ª –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏
    size_t len = _tcslen(searchName);
    if (len > 0 && searchName[len - 1] == _T('\n'))
    {
        searchName[len - 1] = _T('\0');
    }
    
    if (_tcslen(searchName) == 0)
    {
        _tcscpy_s(searchName, MAX_PATH, _T("explorer.exe"));
    }
    
    _tprintf(_T("\n–ò—â–µ–º –ø—Ä–æ—Ü–µ—Å—Å—ã —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ: %s\n\n"), searchName);
    
    // –°–æ–∑–¥–∞–µ–º —Å–Ω–∏–º–æ–∫ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
    HANDLE hSnapshot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);
    
    if (hSnapshot == INVALID_HANDLE_VALUE)
    {
        PrintError("CreateToolhelp32Snapshot", GetLastError());
        return;
    }
    
    PROCESSENTRY32 pe32;
    pe32.dwSize = sizeof(PROCESSENTRY32);
    
    int foundCount = 0;
    
    if (Process32First(hSnapshot, &pe32))
    {
        _tprintf(_T("%-8s  %-40s  %-8s  %-8s\n"), 
                 _T("PID"), _T("–ò–º—è –ø—Ä–æ—Ü–µ—Å—Å–∞"), _T("–ü–æ—Ç–æ–∫–æ–≤"), _T("–†–æ–¥–∏—Ç–µ–ª—å"));
        _tprintf(_T("--------------------------------------------------------------------------------\n"));
        
        do
        {
            // –ü–æ–∏—Å–∫ –ø–æ —á–∞—Å—Ç–∏—á–Ω–æ–º—É —Å–æ–≤–ø–∞–¥–µ–Ω–∏—é (–±–µ–∑ —É—á–µ—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞)
            if (_tcsstr(_tcslwr(_tcsdup(pe32.szExeFile)), _tcslwr(_tcsdup(searchName))) != NULL)
            {
                PrintProcessInfo(&pe32);
                foundCount++;
            }
        } while (Process32Next(hSnapshot, &pe32));
    }
    
    if (foundCount == 0)
    {
        _tprintf(_T("–ü—Ä–æ—Ü–µ—Å—Å—ã —Å –∏–º–µ–Ω–µ–º '%s' –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.\n"), searchName);
    }
    else
    {
        _tprintf(_T("\n–ù–∞–π–¥–µ–Ω–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤: %d\n"), foundCount);
    }
    
    CloseHandle(hSnapshot);
}

// –§—É–Ω–∫—Ü–∏—è 5: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è
void ManageProcessEnvironment()
{
    _tprintf(_T("\n=== –£–ü–†–ê–í–õ–ï–ù–ò–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ú–ò –û–ö–†–£–ñ–ï–ù–ò–Ø ===\n\n"));
    
    _tprintf(_T("1. –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è\n"));
    _tprintf(_T("2. –ü–æ–ª—É—á–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π\n"));
    _tprintf(_T("3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–æ–≤—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é\n"));
    _tprintf(_T("4. –£–¥–∞–ª–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é\n"));
    _tprintf(_T("–í–∞—à –≤—ã–±–æ—Ä: "));
    
    TCHAR choice[10];
    _fgetts(choice, sizeof(choice) / sizeof(TCHAR), stdin);
    
    switch (_ttoi(choice))
    {
    case 1:
        {
            _tprintf(_T("\n=== –í–°–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï –û–ö–†–£–ñ–ï–ù–ò–Ø ===\n\n"));
            
            // –ü–æ–ª—É—á–∞–µ–º –±–ª–æ–∫ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
            LPTCH env = GetEnvironmentStrings();
            
            if (env == NULL)
            {
                PrintError("GetEnvironmentStrings", GetLastError());
                return;
            }
            
            // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –∫–∞–∫ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å—Ç—Ä–æ–∫
            // –ö–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞: VAR=value\0, –±–ª–æ–∫ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –¥–≤–æ–π–Ω—ã–º \0\0
            int count = 0;
            for (LPTCH var = env; *var; var += _tcslen(var) + 1)
            {
                _tprintf(_T("%s\n"), var);
                count++;
            }
            
            FreeEnvironmentStrings(env);
            _tprintf(_T("\n–í—Å–µ–≥–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö: %d\n"), count);
        }
        break;
        
    case 2:
        {
            _tprintf(_T("\n–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π: "));
            TCHAR varName[MAX_PATH];
            _fgetts(varName, MAX_PATH, stdin);
            
            size_t len = _tcslen(varName);
            if (len > 0 && varName[len - 1] == _T('\n'))
            {
                varName[len - 1] = _T('\0');
            }
            
            TCHAR buffer[4096];
            DWORD result = GetEnvironmentVariable(varName, buffer, sizeof(buffer) / sizeof(TCHAR));
            
            if (result == 0)
            {
                DWORD error = GetLastError();
                if (error == ERROR_ENVVAR_NOT_FOUND)
                {
                    _tprintf(_T("–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è '%s' –Ω–µ –Ω–∞–π–¥–µ–Ω–∞.\n"), varName);
                }
                else
                {
                    PrintError("GetEnvironmentVariable", error);
                }
            }
            else if (result > sizeof(buffer) / sizeof(TCHAR))
            {
                _tprintf(_T("–ó–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω–æ–µ (%lu —Å–∏–º–≤–æ–ª–æ–≤).\n"), result);
            }
            else
            {
                _tprintf(_T("%s = %s\n"), varName, buffer);
            }
        }
        break;
        
    case 3:
        {
            _tprintf(_T("\n–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π: "));
            TCHAR varName[MAX_PATH];
            _fgetts(varName, MAX_PATH, stdin);
            
            size_t len = _tcslen(varName);
            if (len > 0 && varName[len - 1] == _T('\n'))
            {
                varName[len - 1] = _T('\0');
            }
            
            _tprintf(_T("–í–≤–µ–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ: "));
            TCHAR varValue[MAX_PATH];
            _fgetts(varValue, MAX_PATH, stdin);
            
            len = _tcslen(varValue);
            if (len > 0 && varValue[len - 1] == _T('\n'))
            {
                varValue[len - 1] = _T('\0');
            }
            
            if (SetEnvironmentVariable(varName, varValue))
            {
                _tprintf(_T("–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è '%s' —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –≤ '%s'\n"), varName, varValue);
                _tprintf(_T("–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ —ç—Ç–æ–º—É –ø—Ä–æ—Ü–µ—Å—Å—É –∏ –µ–≥–æ –¥–æ—á–µ—Ä–Ω–∏–º –ø—Ä–æ—Ü–µ—Å—Å–∞–º.\n"));
            }
            else
            {
                PrintError("SetEnvironmentVariable", GetLastError());
            }
        }
        break;
        
    case 4:
        {
            _tprintf(_T("\n–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è: "));
            TCHAR varName[MAX_PATH];
            _fgetts(varName, MAX_PATH, stdin);
            
            size_t len = _tcslen(varName);
            if (len > 0 && varName[len - 1] == _T('\n'))
            {
                varName[len - 1] = _T('\0');
            }
            
            if (SetEnvironmentVariable(varName, NULL))
            {
                _tprintf(_T("–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è '%s' —É–¥–∞–ª–µ–Ω–∞.\n"), varName);
            }
            else
            {
                PrintError("SetEnvironmentVariable", GetLastError());
            }
        }
        break;
        
    default:
        _tprintf(_T("–ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä.\n"));
        break;
    }
}

// –§—É–Ω–∫—Ü–∏—è 6: –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞
void TerminateProcessDemo()
{
    _tprintf(_T("\n=== –î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ò–Ø –ü–†–û–¶–ï–°–°–ê ===\n\n"));
    
    _tprintf(_T("–í–Ω–∏–º–∞–Ω–∏–µ: —ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–≤–µ—Ä—à–∏—Ç—å –ª—é–±–æ–π –ø—Ä–æ—Ü–µ—Å—Å!\n"));
    _tprintf(_T("–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ.\n\n"));
    
    _tprintf(_T("–í–≤–µ–¥–∏—Ç–µ PID –ø—Ä–æ—Ü–µ—Å—Å–∞ –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è (0 - –æ—Ç–º–µ–Ω–∞): "));
    
    TCHAR pidStr[20];
    _fgetts(pidStr, sizeof(pidStr) / sizeof(TCHAR), stdin);
    
    DWORD pid = _ttoi(pidStr);
    
    if (pid == 0)
    {
        _tprintf(_T("–û—Ç–º–µ–Ω–µ–Ω–æ.\n"));
        return;
    }
    
    // –ü—ã—Ç–∞–µ–º—Å—è –æ—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ—Ü–µ—Å—Å
    HANDLE hProcess = OpenProcess(PROCESS_TERMINATE | PROCESS_QUERY_INFORMATION, FALSE, pid);
    
    if (hProcess == NULL)
    {
        DWORD error = GetLastError();
        
        if (error == ERROR_ACCESS_DENIED)
        {
            _tprintf(_T("–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω. –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:\n"));
            _tprintf(_T("1. –ü—Ä–æ—Ü–µ—Å—Å —Å PID %lu –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç\n"), pid);
            _tprintf(_T("2. –£ –≤–∞—Å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ (–∞–¥–º–∏–Ω?)\n"));
            _tprintf(_T("3. –≠—Ç–æ —Å–∏—Å—Ç–µ–º–Ω—ã–π –∏–ª–∏ PPL –ø—Ä–æ—Ü–µ—Å—Å\n"));
            
            // –ü—Ä–æ–±—É–µ–º –æ—Ç–∫—Ä—ã—Ç—å —Å –º–µ–Ω—å—à–∏–º–∏ –ø—Ä–∞–≤–∞–º–∏
            hProcess = OpenProcess(PROCESS_QUERY_INFORMATION, FALSE, pid);
            if (hProcess != NULL)
            {
                _tprintf(_T("–ü—Ä–æ—Ü–µ—Å—Å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω–æ –Ω–µ –º–æ–∂–µ–º –∑–∞–≤–µ—Ä—à–∏—Ç—å.\n"));
                CloseHandle(hProcess);
            }
        }
        else
        {
            PrintError("OpenProcess", error);
        }
        return;
    }
    
    // –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ—Ü–µ—Å—Å–µ –ø–µ—Ä–µ–¥ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ–º
    TCHAR processName[MAX_PATH] = _T("–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ");
    DWORD size = MAX_PATH;
    QueryFullProcessImageName(hProcess, 0, processName, &size);
    
    _tprintf(_T("–ü—Ä–æ—Ü–µ—Å—Å –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:\n"));
    _tprintf(_T("  PID: %lu\n"), pid);
    _tprintf(_T("  –ò–º—è: %s\n"), processName);
    
    _tprintf(_T("\n–í—ã —É–≤–µ—Ä–µ–Ω—ã —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –∑–∞–≤–µ—Ä—à–∏—Ç—å —ç—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å? (y/N): "));
    
    TCHAR confirm[10];
    _fgetts(confirm, sizeof(confirm) / sizeof(TCHAR), stdin);
    
    if (_totlower(confirm[0]) == _T('y'))
    {
        if (TerminateProcess(hProcess, 0))
        {
            _tprintf(_T("–ü—Ä–æ—Ü–µ—Å—Å –∑–∞–≤–µ—Ä—à–µ–Ω –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ.\n"));
        }
        else
        {
            PrintError("TerminateProcess", GetLastError());
        }
    }
    else
    {
        _tprintf(_T("–û—Ç–º–µ–Ω–µ–Ω–æ.\n"));
    }
    
    CloseHandle(hProcess);
}

// –§—É–Ω–∫—Ü–∏—è 7: –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–º –ø—Ä–æ—Ü–µ—Å—Å–µ
void ProcessInfoDemo()
{
    _tprintf(_T("\n=== –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –¢–ï–ö–£–©–ï–ú –ü–†–û–¶–ï–°–°–ï ===\n\n"));
    
    // PID —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
    DWORD pid = GetCurrentProcessId();
    _tprintf(_T("PID —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞: %lu\n"), pid);
    
    // –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
    HANDLE hProcess = GetCurrentProcess();
    _tprintf(_T("–ü—Å–µ–≤–¥–æ–¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞: 0x%p\n"), hProcess);
    
    // –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å–∞
    DWORD priority = GetPriorityClass(hProcess);
    _tprintf(_T("–ö–ª–∞—Å—Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞: "));
    
    switch (priority)
    {
    case NORMAL_PRIORITY_CLASS:
        _tprintf(_T("NORMAL_PRIORITY_CLASS\n"));
        break;
    case HIGH_PRIORITY_CLASS:
        _tprintf(_T("HIGH_PRIORITY_CLASS\n"));
        break;
    case REALTIME_PRIORITY_CLASS:
        _tprintf(_T("REALTIME_PRIORITY_CLASS\n"));
        break;
    case IDLE_PRIORITY_CLASS:
        _tprintf(_T("IDLE_PRIORITY_CLASS\n"));
        break;
    case BELOW_NORMAL_PRIORITY_CLASS:
        _tprintf(_T("BELOW_NORMAL_PRIORITY_CLASS\n"));
        break;
    case ABOVE_NORMAL_PRIORITY_CLASS:
        _tprintf(_T("ABOVE_NORMAL_PRIORITY_CLASS\n"));
        break;
    default:
        _tprintf(_T("0x%08lX\n"), priority);
        break;
    }
    
    // –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –ø—Ä–æ—Ü–µ—Å—Å–∞
    FILETIME creationTime, exitTime, kernelTime, userTime;
    if (GetProcessTimes(hProcess, &creationTime, &exitTime, &kernelTime, &userTime))
    {
        SYSTEMTIME sysTime;
        FileTimeToSystemTime(&creationTime, &sysTime);
        
        _tprintf(_T("–í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è: %02d:%02d:%02d\n"), 
                 sysTime.wHour, sysTime.wMinute, sysTime.wSecond);
        
        // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤—Ä–µ–º—è –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã
        ULARGE_INTEGER kernel, user;
        kernel.LowPart = kernelTime.dwLowDateTime;
        kernel.HighPart = kernelTime.dwHighDateTime;
        user.LowPart = userTime.dwLowDateTime;
        user.HighPart = userTime.dwHighDateTime;
        
        _tprintf(_T("–í—Ä–µ–º—è –≤ —è–¥—Ä–µ: %llu –º—Å\n"), kernel.QuadPart / 10000);
        _tprintf(_T("–í—Ä–µ–º—è –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º —Ä–µ–∂–∏–º–µ: %llu –º—Å\n"), user.QuadPart / 10000);
    }
    
    // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–∞–º—è—Ç–∏
    PROCESS_MEMORY_COUNTERS pmc;
    if (GetProcessMemoryInfo(hProcess, &pmc, sizeof(pmc)))
    {
        _tprintf(_T("\n–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏:\n"));
        _tprintf(_T("  –ü–∏–∫–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: %lu –ö–ë\n"), pmc.PeakWorkingSetSize / 1024);
        _tprintf(_T("  –¢–µ–∫—É—â–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: %lu –ö–ë\n"), pmc.WorkingSetSize / 1024);
        _tprintf(_T("  –ü–∏–∫–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—á–Ω–æ–≥–æ —Ñ–∞–π–ª–∞: %lu –ö–ë\n"), pmc.PeakPagefileUsage / 1024);
        _tprintf(_T("  –¢–µ–∫—É—â–∏–π —Ä–∞–∑–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—á–Ω–æ–≥–æ —Ñ–∞–π–ª–∞: %lu –ö–ë\n"), pmc.PagefileUsage / 1024);
    }
    
    // –ù–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º hProcess - —ç—Ç–æ –ø—Å–µ–≤–¥–æ–¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä
}

// –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è: –ø–µ—á–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø—Ä–æ—Ü–µ—Å—Å–µ
void PrintProcessInfo(PROCESSENTRY32* pe)
{
    _tprintf(_T("%-8lu  %-40s  %-8lu  %-8lu\n"), 
             pe->th32ProcessID, 
             pe->szExeFile, 
             pe->cntThreads, 
             pe->th32ParentProcessID);
}

// –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è: –æ–∂–∏–¥–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å —Ç–∞–π–º–∞—É—Ç–æ–º
void WaitForProcessWithTimeout(HANDLE hProcess, DWORD timeoutMs)
{
    DWORD waitResult = WaitForSingleObject(hProcess, timeoutMs);
    
    switch (waitResult)
    {
    case WAIT_OBJECT_0:
        {
            DWORD exitCode;
            if (GetExitCodeProcess(hProcess, &exitCode))
            {
                _tprintf(_T("–ü—Ä–æ—Ü–µ—Å—Å –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –∫–æ–¥–æ–º: %lu\n"), exitCode);
            }
        }
        break;
        
    case WAIT_TIMEOUT:
        _tprintf(_T("–¢–∞–π–º–∞—É—Ç! –ü—Ä–æ—Ü–µ—Å—Å –≤—Å–µ –µ—â–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è.\n"));
        _tprintf(_T("–•–æ—Ç–∏—Ç–µ –∑–∞–≤–µ—Ä—à–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å? (y/N): "));
        
        TCHAR choice[10];
        _fgetts(choice, sizeof(choice) / sizeof(TCHAR), stdin);
        
        if (_totlower(choice[0]) == _T('y'))
        {
            if (TerminateProcess(hProcess, 1))
            {
                _tprintf(_T("–ü—Ä–æ—Ü–µ—Å—Å –∑–∞–≤–µ—Ä—à–µ–Ω –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ.\n"));
            }
            else
            {
                PrintError("TerminateProcess", GetLastError());
            }
        }
        break;
        
    case WAIT_FAILED:
        PrintError("WaitForSingleObject", GetLastError());
        break;
    }
}

// –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è: –≤—ã–≤–æ–¥ –æ—à–∏–±–∫–∏
void PrintError(const char* functionName, DWORD errorCode)
{
    LPTSTR errorMsg = NULL;
    
    FormatMessage(
        FORMAT_MESSAGE_ALLOCATE_BUFFER | 
        FORMAT_MESSAGE_FROM_SYSTEM |
        FORMAT_MESSAGE_IGNORE_INSERTS,
        NULL,
        errorCode,
        MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT),
        (LPTSTR)&errorMsg,
        0,
        NULL
    );
    
    if (errorMsg != NULL)
    {
        // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ –º–Ω–æ–≥–æ–±–∞–π—Ç–æ–≤—É—é —Å—Ç—Ä–æ–∫—É –¥–ª—è –≤—ã–≤–æ–¥–∞
        size_t converted = 0;
        char mbErrorMsg[512];
        wcstombs_s(&converted, mbErrorMsg, errorMsg, sizeof(mbErrorMsg));
        
        printf("–û—à–∏–±–∫–∞ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ %s (–∫–æ–¥ %lu): %s", functionName, errorCode, mbErrorMsg);
        LocalFree(errorMsg);
    }
    else
    {
        printf("–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ %s: –∫–æ–¥ %lu\n", functionName, errorCode);
    }
}

// –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è: –≤—ã–≤–æ–¥ –º–µ–Ω—é
void PrintMenu()
{
    _tprintf(_T("\n=== –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ ===\n\n"));
    
    _tprintf(_T("1. –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–æ—Ü–µ—Å—Å\n"));
    _tprintf(_T("2. –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å —Å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –≤—ã–≤–æ–¥–∞\n"));
    _tprintf(_T("3. –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã\n"));
    _tprintf(_T("4. –ù–∞–π—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å –ø–æ –∏–º–µ–Ω–∏\n"));
    _tprintf(_T("5. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è\n"));
    _tprintf(_T("6. –ó–∞–≤–µ—Ä—à–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å\n"));
    _tprintf(_T("7. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–º –ø—Ä–æ—Ü–µ—Å—Å–µ\n"));
    _tprintf(_T("8. –í—ã—Ö–æ–¥\n\n"));
}
```

---

## üîß **–ö–û–ú–ü–ò–õ–Ø–¶–ò–Ø –ò –ó–ê–ü–£–°–ö:**

### **–í Visual Studio:**
1. –°–æ–∑–¥–∞–π—Ç–µ **–∫–æ–Ω—Å–æ–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**
2. –í–∫–ª—é—á–∏—Ç–µ –æ–ø—Ü–∏—é **"Character Set: Use Unicode Character Set"**
3. –î–æ–±–∞–≤—å—Ç–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏: `kernel32.lib`, `user32.lib`, `psapi.lib`
4. –í—Å—Ç–∞–≤—å—Ç–µ –∫–æ–¥ –≤ `main.c`
5. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞

### **–ö–æ–º–∞–Ω–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞:**
```bash
cl lesson3.c /link kernel32.lib user32.lib psapi.lib /D UNICODE /D _UNICODE
```

---

## üìã **–ê–ù–ê–õ–ò–ó –ü–†–û–ì–†–ê–ú–ú–´:**

1. –ü–æ—á–µ–º—É –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `TerminateProcessDemo()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–≤–µ –ø–æ–ø—ã—Ç–∫–∏ –≤—ã–∑–æ–≤–∞ `OpenProcess()`?
2. –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç, –µ—Å–ª–∏ –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è –∑–∞–≤–µ—Ä—à–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, `csrss.exe`)?
3. –ü–æ—á–µ–º—É –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –∏–∑ `GetCurrentProcess()` –Ω–µ –Ω—É–∂–Ω–æ –∑–∞–∫—Ä—ã–≤–∞—Ç—å?
4. –ö–∞–∫–æ–π —Å–ø–æ—Å–æ–± –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞: `TerminateProcess()` –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è WM_CLOSE?
5. –ü–æ—á–µ–º—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ `SetEnvironmentVariable()`, –Ω–µ –≤–∏–¥–Ω—ã –¥—Ä—É–≥–∏–º —É–∂–µ –∑–∞–ø—É—â–µ–Ω–Ω—ã–º –ø—Ä–æ—Ü–µ—Å—Å–∞–º?

---

## üéØ **–ü–†–ê–ö–¢–ò–ß–ï–°–ö–ò–ï –ó–ê–î–ê–ù–ò–Ø –î–õ–Ø –°–ê–ú–û–°–¢–û–Ø–¢–ï–õ–¨–ù–û–ô –†–ê–ë–û–¢–´:**

### **–£—Ä–æ–≤–µ–Ω—å 1: –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–æ–¥–∞**
1. –î–æ–±–∞–≤—å—Ç–µ –≤ `ListAllProcesses()` —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –ø–æ PID –∏–ª–∏ –∏–º–µ–Ω–∏
2. –†–∞—Å—à–∏—Ä—å—Ç–µ `FindProcessByName()` –ø–æ–∏—Å–∫–æ–º –ø–æ –ø—É—Ç–∏ –∫ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–º—É —Ñ–∞–π–ª—É
3. –î–æ–±–∞–≤—å—Ç–µ –≤ `CreateSimpleProcess()` –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–∫–∞–∑–∞–Ω–∏—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞

### **–£—Ä–æ–≤–µ–Ω—å 2: –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**
1. –†–µ–∞–ª–∏–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é "–î–µ—Ä–µ–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤" ‚Äî –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–µ—Ä–∞—Ä—Ö–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
2. –°–æ–∑–¥–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å –ø—Ä–∞–≤–∞–º–∏ –¥—Ä—É–≥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `CreateProcessWithLogonW`)
3. –î–æ–±–∞–≤—å—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤ (–ø–∞–º—è—Ç—å, CPU) –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞

### **–£—Ä–æ–≤–µ–Ω—å 3: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –∑–∞–¥–∞—á–∏**
1. –†–µ–∞–ª–∏–∑—É–π—Ç–µ –ø—Ä–æ—Å—Ç–æ–π –æ—Ç–ª–∞–¥—á–∏–∫ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ ‚Äî –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∫—É, –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–æ–≤
2. –°–æ–∑–¥–∞–π—Ç–µ
